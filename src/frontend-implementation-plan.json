{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Police location updates + SOS targeting copy updates (20m, nearest 2 police)",
  "requirements": [
    {
      "id": "REQ-3",
      "summary": "Add periodic police location updates while Police interface is open and rely on backend-returned targeted SOS alerts without extra client filtering.",
      "acceptanceCriteria": [
        "`frontend/src/hooks/useQueries.ts` includes a new React Query mutation hook for the new backend police-location update method.",
        "`frontend/src/pages/PoliceInterface.tsx` calls the police-location update mutation on an interval (and on initial location acquisition), similar to the ambulance location update behavior.",
        "PoliceInterface continues to render SOS alerts from `useGetActiveSOSAlerts()` without client-side assumptions that all police see all alerts (i.e., no extra filtering needed beyond what backend returns)."
      ],
      "file_operations": [
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Add a new React Query mutation hook (e.g., `useUpdatePoliceLocation`) that calls the backend actor's `updatePoliceLocation(coordinates)` capability, with appropriate actor-availability checks and query invalidation if needed."
        },
        {
          "path": "frontend/src/pages/PoliceInterface.tsx",
          "operation": "modify",
          "description": "Wire periodic police location updates: import and use the new `useUpdatePoliceLocation` mutation; upon acquiring geolocation and while the page is mounted, send an immediate location update and continue sending updates on an interval (mirroring the Ambulance interface pattern). Keep SOS alert rendering based solely on `useGetActiveSOSAlerts()` results (no added client-side filtering beyond what is already present)."
        }
      ]
    },
    {
      "id": "REQ-4",
      "summary": "Update Ambulance UI copy to reflect SOS targeting to nearest 2 police within 20 meters.",
      "acceptanceCriteria": [
        "In `frontend/src/pages/AmbulanceInterface.tsx`, replace the active SOS status text \"SOS Alert Active - All nearby police units have been notified\" with wording that states \"nearest 2 police\" and \"within 20 meters\".",
        "In `frontend/src/pages/AmbulanceInterface.tsx` instructions, replace the line \"Police units within 1 km will receive immediate notification\" with \"Nearest 2 police units within 20 meters will receive immediate notification\" (or equivalent clear English).",
        "Any other Ambulance UI copy implying broadcast-to-all is updated to match the new behavior."
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/AmbulanceInterface.tsx",
          "operation": "modify",
          "description": "Update user-facing English copy to remove broadcast-to-all/1km implications: adjust the active SOS status message, the inactive SOS button helper text, and the 'How it works' bullet to explicitly state SOS targets the nearest 2 police units within 20 meters."
        }
      ]
    }
  ]
}